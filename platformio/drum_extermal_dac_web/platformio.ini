[env:esp32dev]
platform = espressif32@5.2.0
board = esp32dev
framework = arduino

# Audio and Mozzi configuration - Force correct audio rate
build_flags = 
    -DMOZZI_AUDIO_MODE=MOZZI_OUTPUT_I2S_DAC
    -DMOZZI_AUDIO_RATE=16384
    -DMOZZI_CONTROL_RATE=128
    -DMOZZI_I2S_PIN_BCK=26
    -DMOZZI_I2S_PIN_WS=25
    -DMOZZI_I2S_PIN_DATA=5

# Monitor configuration
monitor_speed = 115200

# Libraries
lib_deps = 
    sensorium/Mozzi@^2.0.1
    bblanchon/ArduinoJson@^6.21.3

# Memory optimization
board_build.partitions = huge_app.csv
board_build.filesystem = littlefs

# Additional build settings for better performance
build_unflags = 
    -std=gnu++11

build_flags_extra = 
    -std=gnu++17
    -O2
    -DBOARD_HAS_PSRAM
    -mfix-esp32-psram-cache-issue